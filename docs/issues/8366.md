# #8366: `pass` test failures on 32-bit systems

- **URL:** https://github.com/WebAssembly/binaryen/issues/8366
- **Author:** stevenfontanella
- **Created:** 2026-02-24
- **Updated:** 2026-02-24

## Description

When running

```sh
cmake -G Ninja -DCMAKE_CXX_FLAGS="-m32" -DCMAKE_C_FLAGS="-m32" -DCMAKE_BUILD_TYPE=Debug .
ninja
python3 check.py lit
```

I get test failures in `passes/O_fast-math.wast` and `passes/optimize-instructions-mvp.wast`. Both tests give the wrong NaN:

```
$ "filecheck" "/usr/local/google/home/stevenfont/code/binaryen/test/lit/passes/O_fast-math.wast"
# command output:
/usr/local/google/home/stevenfont/code/binaryen/test/lit/passes/O_fast-math.wast:41:17: error: CHECK-NEXT: expected string not found in input
 ;; CHECK-NEXT: (f32.const -nan:0x23017a)
                ^
<stdin>:19:1: note: scanning from here
  (f32.const -nan:0x63017a)
^

error: command failed with exit status: 1
```

## Comments (2)

### rathann (2026-02-24)

I'm not getting those on Fedora. Try with `-m32 -msse2 -mfpmath=sse`.

---

### stevenfontanella (2026-02-24)

I see. I tried

```
cmake -G Ninja -DCMAKE_CXX_FLAGS="-m32 -msse2 -mfpmath=sse" -DCMAKE_C_FLAGS="-m32 -msse2 -mfpmath=sse" -DCMAKE_BUILD_TYPE=Debug .
ninja
python3 check.py lit
```

and still got the same failure.

I guess it's possible that a fast math pass would have some non-determinism in its results, depending on the platform? If that's the case, then the test should account for this ideally. And I'm not sure if it's the same for `optimize-instructions-mvp.wast`.

---

