# #5752: optimise LSBit mask (followed by branch) to use `ctz`

- **URL:** https://github.com/WebAssembly/binaryen/issues/5752
- **Author:** ggreif
- **Created:** 2023-06-05
- **Updated:** 2024-12-10

## Description

I have code snippets like
``` wasm
i32.const 1
i32.and
i32.eqz
br_if 1 (;@1;)
```
which could be optimised to
``` wasm
i32.ctz
br_if 1 (;@1;)
```
Similar analogous transformations:
- `i32.const 1; i32.and; i32.eqz; if` to `i32.ctz; if`
- `i32.const 1; i32.and; if` to `i32.ctz; if` (with legs swapped)
- `i32.const 2_147_483_648; i32.and; if` to `i32.clz; if` (with legs swapped)
- `i32.const 31; i32.shr_u; if` to `i32.clz; if` (with legs swapped)
- possibly 64-bit variants (but here probably instructions for truncation need to be added)
- what about sightedness testing? (cmp against 0 --> `clz`)

